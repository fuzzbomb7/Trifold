"use strict";

// Local variables - set these in the HTML file!
var locationId = null;
var eventId = null; // Constants

var SEARCH_LIMIT = 25;
$(document).ready(function () {
  // Toastr options
  toastr.options.progressBar = true;
  toastr.options.timeOut = 3000;
  toastr.options.positionClass = 'toast-bottom-left'; // Manual add autocompletes

  $('#Brewery_BreweryName').autoComplete({
    resolverSettings: {
      url: '/' + eventId + '/Beer/Brewery/Api/Search'
    },
    autoSelect: false,
    minLength: 2
  });
  $('#Style').autoComplete({
    resolverSettings: {
      url: '/' + eventId + '/Beer/Style/Api/Search'
    },
    autoSelect: false,
    minLength: 2
  });
  $('#Brewery_BreweryCity').autoComplete({
    resolverSettings: {
      url: '/' + eventId + '/Beer/City/Api/Search'
    },
    autoSelect: false,
    minLength: 2
  });
}); // Search for beer

var table = null;
var limit = SEARCH_LIMIT;
var searchTerm = null;

function search() {
  searchTerm = $('#beer-search').val();
  if (searchTerm.trim() === '') return;
  var url = '/Beer/Api/Search?search=' + searchTerm;

  if (table === null) {
    table = $('#table').DataTable({
      pageLength: 25,
      autoWidth: false,
      dom: 'tipr',
      ajax: {
        dataSrc: 'beers',
        url: url
      },
      columns: [{
        data: 'labelUrl',
        render: function render(data, type, row, meta) {
          return '<img src="' + data + '" height="50" />';
        }
      }, {
        data: 'beerName'
      }, {
        data: 'brewery.breweryName'
      }, {
        data: 'brewery.breweryCity'
      }, {
        data: 'style'
      }, {
        data: 'abv'
      }, {
        data: 'ibu'
      }, {
        data: 'untappdBeerId',
        render: function render(data, type, row, meta) {
          return '<button class="btn btn-primary add" data-id="' + data + '">Add</button>';
        }
      }]
    });
    $('#table').parent().addClass('table-overflow'); // DataTables Ajax load event

    table.on('xhr.dt', function (e, settings, json, xhr) {
      $('#spinner').html("");
    });
    $('#search-results').css('visibility', 'visible');
  } else {
    table.ajax.url(url).load();
  }

  $('#spinner').html('<i class="fas fa-spinner fa-spin"></i>');
  limit = SEARCH_LIMIT;
} // Search button


$('#search-button').click(function () {
  search();
}); // Search on enter key

$('#beer-search').keypress(function (e) {
  if (e.which === 13) {
    search();
    return false;
  }
}); // Clear button

$('#clear-button').click(function () {
  $('#beer-search').val('');
}); // Add from search

$('.card').on('click', '.add', function () {
  var id = $(this).data('id');
  var json = table.ajax.json();
  var find = json.beers.find(function (x) {
    return x.untappdBeerId === id;
  });
  find.locationId = locationId;
  $.post('/' + eventId + '/Beer/Api/Add', {
    beer: find
  }).done(function (data) {
    if (data === 0) {
      toastAddSuccess(find);
      newBeerAdded();
    } else if (data === 1) {
      toastAddFail(find);
    } else if (data === 2) {
      toastAddDuplicate(find);
    }
  }).fail(function () {
    toastAddFail(find);
  });
}); // Beer add toasts

function toastAddSuccess(beer) {
  toastr.success("Added to Beer List!", "".concat(beer.brewery.breweryName, " ").concat(beer.beerName));
}

function toastAddFail(beer) {
  toastr.error("Problem adding \"".concat(beer.brewery.breweryName, " ").concat(beer.beerName, "\". Please try again."), "Error");
}

function toastAddDuplicate(beer) {
  toastr.warning("\"".concat(beer.brewery.breweryName, " ").concat(beer.beerName, "\" is already in your Beer List!"), "Duplicate Beer");
} // Add manually


$('#add-manual').click(function () {
  var validate = $('#add-edit-form').validate();
  var isValid = validate.form();
  if (isValid === false) return;
  var beer = {
    brewery: {
      breweryName: $('#Brewery_BreweryName').val(),
      breweryCity: $('#Brewery_BreweryCity').val()
    },
    beerName: $('#BeerName').val(),
    style: $('#Style').val(),
    abv: $('#Abv').val(),
    ibu: $('#Ibu').val(),
    description: $('#Description').val(),
    untappdBeerId: $('#UntappdBeerId').val(),
    locationId: locationId
  };
  $.post('/' + eventId + '/Beer/Api/Add', {
    beer: beer
  }).done(function (data) {
    if (data === 0) {
      toastAddSuccess(beer);
      newBeerAdded();
      $('#Brewery_BreweryName').val('');
      $('#BeerName').val('');
      $('#Style').val('');
      $('#Abv').val('');
      $('#Ibu').val('');
      $('#Description').val('');
      $('#Brewery_BreweryCity').val('');
      $('#UntappdBeerId').val('');
    } else if (data === 1) {
      toastAddFail(beer);
    } else if (data === 2) {
      toastAddDuplicate(beer);
    }
  }).fail(function () {
    toastAddFail(beer);
  });
}); // Load more

$('#load-more').click(function () {
  limit += SEARCH_LIMIT;

  if (limit > 50) {
    toastr.warning("Max 50 results! Please try another search.");
    return;
  }

  var url = "/Beer/Api/Search?search=".concat(searchTerm, "&limit=").concat(limit);
  table.ajax.url(url).load(function () {
    table.page('last').draw('page');
  });
  $("html, body").animate({
    scrollTop: 0
  }, "slow");
}); // Autocomplete table name

$('#Location_TableNumber').change(function () {
  $.get('/' + eventId + '/Beer/Location/Api/Name', {
    tableNumber: $(this).val()
  }).done(function (data) {
    $('#Location_AlternateName').val(data);
  });
}); // Override this function to handle the add new beer event

function newBeerAdded(beer) {}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL2FkZGJlZXIuanMiXSwibmFtZXMiOlsibG9jYXRpb25JZCIsImV2ZW50SWQiLCJTRUFSQ0hfTElNSVQiLCIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsInRvYXN0ciIsIm9wdGlvbnMiLCJwcm9ncmVzc0JhciIsInRpbWVPdXQiLCJwb3NpdGlvbkNsYXNzIiwiYXV0b0NvbXBsZXRlIiwicmVzb2x2ZXJTZXR0aW5ncyIsInVybCIsImF1dG9TZWxlY3QiLCJtaW5MZW5ndGgiLCJ0YWJsZSIsImxpbWl0Iiwic2VhcmNoVGVybSIsInNlYXJjaCIsInZhbCIsInRyaW0iLCJEYXRhVGFibGUiLCJwYWdlTGVuZ3RoIiwiYXV0b1dpZHRoIiwiZG9tIiwiYWpheCIsImRhdGFTcmMiLCJjb2x1bW5zIiwiZGF0YSIsInJlbmRlciIsInR5cGUiLCJyb3ciLCJtZXRhIiwicGFyZW50IiwiYWRkQ2xhc3MiLCJvbiIsImUiLCJzZXR0aW5ncyIsImpzb24iLCJ4aHIiLCJodG1sIiwiY3NzIiwibG9hZCIsImNsaWNrIiwia2V5cHJlc3MiLCJ3aGljaCIsImlkIiwiZmluZCIsImJlZXJzIiwieCIsInVudGFwcGRCZWVySWQiLCJwb3N0IiwiYmVlciIsImRvbmUiLCJ0b2FzdEFkZFN1Y2Nlc3MiLCJuZXdCZWVyQWRkZWQiLCJ0b2FzdEFkZEZhaWwiLCJ0b2FzdEFkZER1cGxpY2F0ZSIsImZhaWwiLCJzdWNjZXNzIiwiYnJld2VyeSIsImJyZXdlcnlOYW1lIiwiYmVlck5hbWUiLCJlcnJvciIsIndhcm5pbmciLCJ2YWxpZGF0ZSIsImlzVmFsaWQiLCJmb3JtIiwiYnJld2VyeUNpdHkiLCJzdHlsZSIsImFidiIsImlidSIsImRlc2NyaXB0aW9uIiwicGFnZSIsImRyYXciLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiY2hhbmdlIiwiZ2V0IiwidGFibGVOdW1iZXIiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxJQUFJQSxVQUFVLEdBQUcsSUFBakI7QUFDQSxJQUFJQyxPQUFPLEdBQUcs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QUU7QUFBYixHQUF4QixFQUEwQyxNQUExQztBQUNBLENBWEQsRSxDQWFBOztBQUNBMUUsQ0FBQyxDQUFDLHVCQUFELENBQUQsQ0FBMkIyRSxNQUEzQixDQUFrQyxZQUFZO0FBQzdDM0UsRUFBQUEsQ0FBQyxDQUFDNEUsR0FBRixDQUFNLE1BQU05RSxPQUFOLEdBQWdCLHlCQUF0QixFQUFpRDtBQUFFK0UsSUFBQUEsV0FBVyxFQUFFN0UsQ0FBQyxDQUFDLElBQUQsQ0FBRCxDQUFRaUIsR0FBUjtBQUFmLEdBQWpELEVBQ0VrQyxJQURGLENBQ08sVUFBVXpCLElBQVYsRUFBZ0I7QUFDckIxQixJQUFBQSxDQUFDLENBQUMseUJBQUQsQ0FBRCxDQUE2QmlCLEdBQTdCLENBQWlDUyxJQUFqQztBQUNBLEdBSEY7QUFJQSxDQUxELEUsQ0FPQTs7QUFDQSxTQUFTMkIsWUFBVCxDQUFzQkgsSUFBdEIsRUFBNEIsQ0FBRSIsInNvdXJjZXNDb250ZW50IjpbIi8vIExvY2FsIHZhcmlhYmxlcyAtIHNldCB0aGVzZSBpbiB0aGUgSFRNTCBmaWxlIVxyXG52YXIgbG9jYXRpb25JZCA9IG51bGw7XHJcbnZhciBldmVudElkID0gbnVsbDtcclxuXHJcbi8vIENvbnN0YW50c1xyXG5jb25zdCBTRUFSQ0hfTElNSVQgPSAyNTtcclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHQvLyBUb2FzdHIgb3B0aW9uc1xyXG5cdHRvYXN0ci5vcHRpb25zLnByb2dyZXNzQmFyID0gdHJ1ZTtcclxuXHR0b2FzdHIub3B0aW9ucy50aW1lT3V0ID0gMzAwMDtcclxuXHR0b2FzdHIub3B0aW9ucy5wb3NpdGlvbkNsYXNzID0gJ3RvYXN0LWJvdHRvbS1sZWZ0JztcclxuXHJcblx0Ly8gTWFudWFsIGFkZCBhdXRvY29tcGxldGVzXHJcblx0JCgnI0JyZXdlcnlfQnJld2VyeU5hbWUnKS5hdXRvQ29tcGxldGUoe1xyXG5cdFx0cmVzb2x2ZXJTZXR0aW5nczoge1xyXG5cdFx0XHR1cmw6ICcvJyArIGV2ZW50SWQgKyAnL0JlZXIvQnJld2VyeS9BcGkvU2VhcmNoJyxcclxuXHRcdH0sXHJcblx0XHRhdXRvU2VsZWN0OiBmYWxzZSxcclxuXHRcdG1pbkxlbmd0aDogMixcclxuXHR9KTtcclxuXHJcblx0JCgnI1N0eWxlJykuYXV0b0NvbXBsZXRlKHtcclxuXHRcdHJlc29sdmVyU2V0dGluZ3M6IHtcclxuXHRcdFx0dXJsOiAnLycgKyBldmVudElkICsgJy9CZWVyL1N0eWxlL0FwaS9TZWFyY2gnLFxyXG5cdFx0fSxcclxuXHRcdGF1dG9TZWxlY3Q6IGZhbHNlLFxyXG5cdFx0bWluTGVuZ3RoOiAyLFxyXG5cdH0pO1xyXG5cclxuXHQkKCcjQnJld2VyeV9CcmV3ZXJ5Q2l0eScpLmF1dG9Db21wbGV0ZSh7XHJcblx0XHRyZXNvbHZlclNldHRpbmdzOiB7XHJcblx0XHRcdHVybDogJy8nICsgZXZlbnRJZCArICcvQmVlci9DaXR5L0FwaS9TZWFyY2gnLFxyXG5cdFx0fSxcclxuXHRcdGF1dG9TZWxlY3Q6IGZhbHNlLFxyXG5cdFx0bWluTGVuZ3RoOiAyLFxyXG5cdH0pO1xyXG5cclxufSk7XHJcblxyXG4vLyBTZWFyY2ggZm9yIGJlZXJcclxudmFyIHRhYmxlID0gbnVsbDtcclxudmFyIGxpbWl0ID0gU0VBUkNIX0xJTUlUO1xyXG52YXIgc2VhcmNoVGVybSA9IG51bGw7XHJcblxyXG5mdW5jdGlvbiBzZWFyY2goKSB7XHJcblx0c2VhcmNoVGVybSA9ICQoJyNiZWVyLXNlYXJjaCcpLnZhbCgpO1xyXG5cdGlmIChzZWFyY2hUZXJtLnRyaW0oKSA9PT0gJycpIHJldHVybjtcclxuXHJcblx0dmFyIHVybCA9ICcvQmVlci9BcGkvU2VhcmNoP3NlYXJjaD0nICsgc2VhcmNoVGVybTtcclxuXHJcblx0aWYgKHRhYmxlID09PSBudWxsKSB7XHJcblxyXG5cdFx0dGFibGUgPSAkKCcjdGFibGUnKS5EYXRhVGFibGUoe1xyXG5cdFx0XHRwYWdlTGVuZ3RoOiAyNSxcclxuXHRcdFx0YXV0b1dpZHRoOiBmYWxzZSxcclxuXHRcdFx0ZG9tOiAndGlwcicsXHJcblx0XHRcdGFqYXg6IHtcclxuXHRcdFx0XHRkYXRhU3JjOiAnYmVlcnMnLFxyXG5cdFx0XHRcdHVybDogdXJsXHJcblx0XHRcdH0sXHJcblx0XHRcdGNvbHVtbnM6IFtcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRkYXRhOiAnbGFiZWxVcmwnLFxyXG5cdFx0XHRcdFx0cmVuZGVyOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93LCBtZXRhKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiAnPGltZyBzcmM9XCInICsgZGF0YSArICdcIiBoZWlnaHQ9XCI1MFwiIC8+JztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHsgZGF0YTogJ2JlZXJOYW1lJyB9LFxyXG5cdFx0XHRcdHsgZGF0YTogJ2JyZXdlcnkuYnJld2VyeU5hbWUnIH0sXHJcblx0XHRcdFx0eyBkYXRhOiAnYnJld2VyeS5icmV3ZXJ5Q2l0eScgfSxcclxuXHRcdFx0XHR7IGRhdGE6ICdzdHlsZScgfSxcclxuXHRcdFx0XHR7IGRhdGE6ICdhYnYnIH0sXHJcblx0XHRcdFx0eyBkYXRhOiAnaWJ1JyB9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGRhdGE6ICd1bnRhcHBkQmVlcklkJyxcclxuXHRcdFx0XHRcdHJlbmRlcjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdywgbWV0YSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYWRkXCIgZGF0YS1pZD1cIicgKyBkYXRhICsgJ1wiPkFkZDwvYnV0dG9uPic7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRdXHJcblx0XHR9KTtcclxuXHJcblx0XHQkKCcjdGFibGUnKS5wYXJlbnQoKS5hZGRDbGFzcygndGFibGUtb3ZlcmZsb3cnKTtcclxuXHJcblx0XHQvLyBEYXRhVGFibGVzIEFqYXggbG9hZCBldmVudFxyXG5cdFx0dGFibGUub24oJ3hoci5kdCcsIGZ1bmN0aW9uIChlLCBzZXR0aW5ncywganNvbiwgeGhyKSB7XHJcblx0XHRcdCQoJyNzcGlubmVyJykuaHRtbChcIlwiKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdCQoJyNzZWFyY2gtcmVzdWx0cycpLmNzcygndmlzaWJpbGl0eScsICd2aXNpYmxlJyk7XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0dGFibGUuYWpheC51cmwodXJsKS5sb2FkKCk7XHJcblx0fVxyXG5cclxuXHQkKCcjc3Bpbm5lcicpLmh0bWwoJzxpIGNsYXNzPVwiZmFzIGZhLXNwaW5uZXIgZmEtc3BpblwiPjwvaT4nKTtcclxuXHRsaW1pdCA9IFNFQVJDSF9MSU1JVDtcclxufVxyXG5cclxuLy8gU2VhcmNoIGJ1dHRvblxyXG4kKCcjc2VhcmNoLWJ1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRzZWFyY2goKTtcclxufSk7XHJcblxyXG4vLyBTZWFyY2ggb24gZW50ZXIga2V5XHJcbiQoJyNiZWVyLXNlYXJjaCcpLmtleXByZXNzKGZ1bmN0aW9uIChlKSB7XHJcblx0aWYgKGUud2hpY2ggPT09IDEzKSB7XHJcblx0XHRzZWFyY2goKTtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcbn0pO1xyXG5cclxuLy8gQ2xlYXIgYnV0dG9uXHJcbiQoJyNjbGVhci1idXR0b24nKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcblx0JCgnI2JlZXItc2VhcmNoJykudmFsKCcnKTtcclxufSk7XHJcblxyXG4vLyBBZGQgZnJvbSBzZWFyY2hcclxuJCgnLmNhcmQnKS5vbignY2xpY2snLCAnLmFkZCcsIGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgaWQgPSAkKHRoaXMpLmRhdGEoJ2lkJyk7XHJcblx0dmFyIGpzb24gPSB0YWJsZS5hamF4Lmpzb24oKTtcclxuXHR2YXIgZmluZCA9IGpzb24uYmVlcnMuZmluZCh4ID0+IHgudW50YXBwZEJlZXJJZCA9PT0gaWQpO1xyXG5cdGZpbmQubG9jYXRpb25JZCA9IGxvY2F0aW9uSWQ7XHJcblxyXG5cdCQucG9zdCgnLycgKyBldmVudElkICsgJy9CZWVyL0FwaS9BZGQnLCB7IGJlZXI6IGZpbmQgfSlcclxuXHRcdC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdGlmIChkYXRhID09PSAwKSB7XHJcblx0XHRcdFx0dG9hc3RBZGRTdWNjZXNzKGZpbmQpO1xyXG5cdFx0XHRcdG5ld0JlZXJBZGRlZCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGRhdGEgPT09IDEpIHtcclxuXHRcdFx0XHR0b2FzdEFkZEZhaWwoZmluZCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAoZGF0YSA9PT0gMikge1xyXG5cdFx0XHRcdHRvYXN0QWRkRHVwbGljYXRlKGZpbmQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmZhaWwoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0b2FzdEFkZEZhaWwoZmluZCk7XHJcblx0XHR9KTtcclxufSk7XHJcblxyXG4vLyBCZWVyIGFkZCB0b2FzdHNcclxuZnVuY3Rpb24gdG9hc3RBZGRTdWNjZXNzKGJlZXIpIHtcclxuXHR0b2FzdHIuc3VjY2VzcyhcIkFkZGVkIHRvIEJlZXIgTGlzdCFcIiwgYCR7YmVlci5icmV3ZXJ5LmJyZXdlcnlOYW1lfSAke2JlZXIuYmVlck5hbWV9YCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvYXN0QWRkRmFpbChiZWVyKSB7XHJcblx0dG9hc3RyLmVycm9yKGBQcm9ibGVtIGFkZGluZyBcIiR7YmVlci5icmV3ZXJ5LmJyZXdlcnlOYW1lfSAke2JlZXIuYmVlck5hbWV9XCIuIFBsZWFzZSB0cnkgYWdhaW4uYCwgXCJFcnJvclwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9hc3RBZGREdXBsaWNhdGUoYmVlcikge1xyXG5cdHRvYXN0ci53YXJuaW5nKGBcIiR7YmVlci5icmV3ZXJ5LmJyZXdlcnlOYW1lfSAke2JlZXIuYmVlck5hbWV9XCIgaXMgYWxyZWFkeSBpbiB5b3VyIEJlZXIgTGlzdCFgLCBcIkR1cGxpY2F0ZSBCZWVyXCIpO1xyXG59XHJcblxyXG4vLyBBZGQgbWFudWFsbHlcclxuJCgnI2FkZC1tYW51YWwnKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcblxyXG5cdHZhciB2YWxpZGF0ZSA9ICQoJyNhZGQtZWRpdC1mb3JtJykudmFsaWRhdGUoKTtcclxuXHR2YXIgaXNWYWxpZCA9IHZhbGlkYXRlLmZvcm0oKTtcclxuXHJcblx0aWYgKGlzVmFsaWQgPT09IGZhbHNlKSByZXR1cm47XHJcblxyXG5cdHZhciBiZWVyID0ge1xyXG5cdFx0YnJld2VyeToge1xyXG5cdFx0XHRicmV3ZXJ5TmFtZTogJCgnI0JyZXdlcnlfQnJld2VyeU5hbWUnKS52YWwoKSxcclxuXHRcdFx0YnJld2VyeUNpdHk6ICQoJyNCcmV3ZXJ5X0JyZXdlcnlDaXR5JykudmFsKCksXHJcblx0XHR9LFxyXG5cdFx0YmVlck5hbWU6ICQoJyNCZWVyTmFtZScpLnZhbCgpLFxyXG5cdFx0c3R5bGU6ICQoJyNTdHlsZScpLnZhbCgpLFxyXG5cdFx0YWJ2OiAkKCcjQWJ2JykudmFsKCksXHJcblx0XHRpYnU6ICQoJyNJYnUnKS52YWwoKSxcclxuXHRcdGRlc2NyaXB0aW9uOiAkKCcjRGVzY3JpcHRpb24nKS52YWwoKSxcclxuXHRcdHVudGFwcGRCZWVySWQ6ICQoJyNVbnRhcHBkQmVlcklkJykudmFsKCksXHJcblx0XHRsb2NhdGlvbklkOiBsb2NhdGlvbklkXHJcblx0fTtcclxuXHJcblx0JC5wb3N0KCcvJyArIGV2ZW50SWQgKyAnL0JlZXIvQXBpL0FkZCcsIHsgYmVlcjogYmVlciB9KVxyXG5cdFx0LmRvbmUoZnVuY3Rpb24gKGRhdGEpIHtcclxuXHRcdFx0aWYgKGRhdGEgPT09IDApIHtcclxuXHRcdFx0XHR0b2FzdEFkZFN1Y2Nlc3MoYmVlcik7XHJcblx0XHRcdFx0bmV3QmVlckFkZGVkKCk7XHJcblxyXG5cdFx0XHRcdCQoJyNCcmV3ZXJ5X0JyZXdlcnlOYW1lJykudmFsKCcnKTtcclxuXHRcdFx0XHQkKCcjQmVlck5hbWUnKS52YWwoJycpO1xyXG5cdFx0XHRcdCQoJyNTdHlsZScpLnZhbCgnJyk7XHJcblx0XHRcdFx0JCgnI0FidicpLnZhbCgnJyk7XHJcblx0XHRcdFx0JCgnI0lidScpLnZhbCgnJyk7XHJcblx0XHRcdFx0JCgnI0Rlc2NyaXB0aW9uJykudmFsKCcnKTtcclxuXHRcdFx0XHQkKCcjQnJld2VyeV9CcmV3ZXJ5Q2l0eScpLnZhbCgnJyk7XHJcblx0XHRcdFx0JCgnI1VudGFwcGRCZWVySWQnKS52YWwoJycpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGRhdGEgPT09IDEpIHtcclxuXHRcdFx0XHR0b2FzdEFkZEZhaWwoYmVlcik7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAoZGF0YSA9PT0gMikge1xyXG5cdFx0XHRcdHRvYXN0QWRkRHVwbGljYXRlKGJlZXIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmZhaWwoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0b2FzdEFkZEZhaWwoYmVlcik7XHJcblx0XHR9KTtcclxufSk7XHJcblxyXG4vLyBMb2FkIG1vcmVcclxuJCgnI2xvYWQtbW9yZScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRsaW1pdCArPSBTRUFSQ0hfTElNSVQ7XHJcblx0aWYgKGxpbWl0ID4gNTApIHtcclxuXHRcdHRvYXN0ci53YXJuaW5nKFwiTWF4IDUwIHJlc3VsdHMhIFBsZWFzZSB0cnkgYW5vdGhlciBzZWFyY2guXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHR2YXIgdXJsID0gYC9CZWVyL0FwaS9TZWFyY2g/c2VhcmNoPSR7c2VhcmNoVGVybX0mbGltaXQ9JHtsaW1pdH1gO1xyXG5cdHRhYmxlLmFqYXgudXJsKHVybCkubG9hZChmdW5jdGlvbiAoKSB7XHJcblx0XHR0YWJsZS5wYWdlKCdsYXN0JykuZHJhdygncGFnZScpO1xyXG5cdH0pO1xyXG5cdCQoXCJodG1sLCBib2R5XCIpLmFuaW1hdGUoeyBzY3JvbGxUb3A6IDAgfSwgXCJzbG93XCIpO1xyXG59KTtcclxuXHJcbi8vIEF1dG9jb21wbGV0ZSB0YWJsZSBuYW1lXHJcbiQoJyNMb2NhdGlvbl9UYWJsZU51bWJlcicpLmNoYW5nZShmdW5jdGlvbiAoKSB7XHJcblx0JC5nZXQoJy8nICsgZXZlbnRJZCArICcvQmVlci9Mb2NhdGlvbi9BcGkvTmFtZScsIHsgdGFibGVOdW1iZXI6ICQodGhpcykudmFsKCkgfSlcclxuXHRcdC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdCQoJyNMb2NhdGlvbl9BbHRlcm5hdGVOYW1lJykudmFsKGRhdGEpO1xyXG5cdFx0fSk7XHJcbn0pO1xyXG5cclxuLy8gT3ZlcnJpZGUgdGhpcyBmdW5jdGlvbiB0byBoYW5kbGUgdGhlIGFkZCBuZXcgYmVlciBldmVudFxyXG5mdW5jdGlvbiBuZXdCZWVyQWRkZWQoYmVlcikge30iXSwiZmlsZSI6ImpzL2FkZGJlZXIuZXM1LmpzIn0=
